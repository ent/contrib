{{- /*gotype: github.com/bionicstork/bionicstork/pkg/entproto/cmd/protoc-gen-entgrpc.serviceGenerator*/ -}}
{{ define "service" }}
// Code generated by protoc-gen-entgrpc. DO NOT EDIT.
package {{ .File.GoPackageName }}

// Note: This is a hack for easy putting the service generated code in a different package
import (
    . "github.com/bionicstork/bionicstork/pkg/common/proto/build/go/entities/backbone"
)
// {{ .Service.GoName }} implements {{ .Service.GoName }}Server
type {{ .Service.GoName }} struct {
    client *{{ .EntPackage.Ident "Client" | ident }}
    Unimplemented{{ .Service.GoName }}Server
}

// New{{ .Service.GoName }} returns a new {{ .Service.GoName }}
func New{{ .Service.GoName }}(client *{{ .EntPackage.Ident "Client" | ident }}) *{{ .Service.GoName }} {
    return &{{ .Service.GoName }}{
        client: client,
    }
}

{{ template "enums" . }}

{{ range .Service.Methods }}
    {{- $idField := $.FieldMap.ID -}}
    {{- $varName := $idField.EntField.Name -}}
    {{- $methodName := .GoName -}}
    {{- $inputName := .Input.GoIdent.GoName -}}

    // {{ .GoName }} implements {{ $.Service.GoName }}Server.{{ .GoName }}
    func (svc *{{ $.Service.GoName }}) {{ .GoName }}(ctx {{ qualify "context" "Context" }}, req *{{ ident .Input.GoIdent }}) (*{{ ident .Output.GoIdent }}, error) {
        {{- if eq $methodName "Get" }}
            {{ template "method_get" (method .) }}
        {{- else if eq $methodName "Delete" }}
            {{ template "method_delete" (method .) }}
        {{- else if or (eq $methodName "Create") (eq $methodName "Update") }}
            {{ template "method_mutate" (method .) }}
        {{- else if eq $methodName "List" }}
            {{ template "method_list" (method .) }}
        {{- else if eq $methodName "ListByRelatedTo" }}
            {{ template "method_list_by_related_to" (method .) }}
        {{- else if eq $methodName "ListByRelatedToPaginated" }}
            {{ template "method_list_by_related_to_paginated" (method .) }}
        {{- end }}
    }
{{ end }}
{{ end }}
